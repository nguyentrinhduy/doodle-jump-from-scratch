(()=>{"use strict";const t=800,e=648;class s{constructor(t){this.loaded=!1,this.image=new Image;let e="./assets/Images/";e+=t.join("/"),e+=".png",this.image.src=e}getNaturalSize(){return[this.image.width,this.image.height]}display(t,e){const s=document.getElementById("game").getContext("2d");s&&s.drawImage(this.image,t[0],t[1],e[0],e[1])}}const i=["Backgrounds","background"],o=["Backgrounds","pause_screen"],n=["Backgrounds","top"],a=["Backgrounds","bottom"],r=["Backgrounds","main_menu"],h=["Player","left"],l=["Player","right"],c=["Player","left_jump"],u=["Player","right_jump"],p=["Buttons","play"],d=["Buttons","pause"],g=["Buttons","play_again"],m=["Buttons","resume"],y=["Lands","normal_land"],f=["Lands","moving_land"],b=["Lands","dust_land"],P=["Buff","propeller_buff"],B=["Buff","jetpack_buff"],S=["Buff","spring_buff"],w=["Bullet","bullet"],v=["Components","game_over"],k=["Buttons","menu"],O=["Monsters","blue_wing_monster"],z=["Monsters","alien_monster"],I=[i,o,n,r,h,l,c,u,["Player","shoot"],p,["Buttons","play_hover"],d,["Buttons","options"],["Buttons","play_again_hover"],g,m,y,f,v,k],R=[[P,4],[B,10],[S,2],[b,4],[O,8],[z,2]];class A{constructor(){this.Sprites={},this.animationSprites={};for(const t of I)this.Sprites[this.getKey(t)]=new s(t);for(const t of R){let e=[];for(let i=0;i<t[1];i++){let o=[...t[0]];o.push(i.toString()),e.push(new s(o))}this.animationSprites[this.getKey(t[0])]=e}}static getInstance(){return A.instance||(A.instance=new A),A.instance}getKey(t){return t.join("_")}getSprite(t){const e=this.getKey(t);return e in this.Sprites||(this.Sprites[e]=new s(t)),this.Sprites[e]}getAnimationSprite(t){const e=this.getKey(t);if(!(e in this.animationSprites))throw new Error("The desired animation sprite does not exist");return this.animationSprites[e]}}class L{transitionTo(t){this.currentScene=t,this.currentScene.setContext(this)}constructor(){this.spriteFactory=A.getInstance(),this.loop=this.loop.bind(this)}run(){this.lastTime=window.performance.now(),requestAnimationFrame(this.loop)}loop(){let t=window.performance.now(),e=t-this.lastTime;this.currentScene.processInput(),this.currentScene.update(e),this.currentScene.render(),this.lastTime=t,requestAnimationFrame(this.loop)}}class x{constructor(){this.offset=[0,0],this.size=[e,t],this.focusedObject=null,this.topBound=-1/0,this.bottomBound=1/0,this.leftBound=-1/0,this.rightBound=1/0}isOutOfRange(t){return this.isOutOfTopRange(t)&&this.isOutOfBottomRange(t)&&this.isOutOfLeftRange(t)&&this.isOutOfRightRange(t)}isOutOfTopRange(t){let e=t.getPosition(),s=t.getSize();return e[1]+s[1]<this.offset[1]}isOutOfBottomRange(t){return t.getPosition()[1]>this.offset[1]+this.size[1]}isOutOfLeftRange(t){let e=t.getPosition(),s=t.getSize();return e[0]+s[0]<this.offset[0]}isOutOfRightRange(t){return t.getPosition()[0]>this.offset[0]+this.size[0]}update(){this.focusedObject&&(this.focusedObject.getPositionY()<=this.offset[1]+this.topBound&&(this.offset[1]=this.focusedObject.getPositionY()-this.topBound),this.focusedObject.getPositionY()>=this.offset[1]+this.bottomBound&&(this.offset[1]=this.focusedObject.getPositionY()-this.bottomBound),this.focusedObject.getPositionX()<=this.offset[0]+this.leftBound&&(this.offset[0]=this.focusedObject.getPositionX()-this.leftBound),this.focusedObject.getPositionX()>=this.offset[0]+this.rightBound&&(this.offset[0]=this.focusedObject.getPositionX()-this.rightBound))}setTopBound(t){this.topBound=t}setBottomBound(t){this.bottomBound=t}setLeftBound(t){this.leftBound=t}setRightBound(t){this.rightBound=t}focusOn(t){this.focusedObject=t}getOffset(){return this.offset}getOffsetX(){return this.offset[0]}getOffsetY(){return this.offset[1]}setOffsetX(t){this.offset[0]=t}setOffsetY(t){this.offset[1]=t}setOffset(t){this.offset=t}}var T,H;!function(t){t[t.Jump=0]="Jump",t[t.ShootUp=1]="ShootUp",t[t.ShootDown=2]="ShootDown",t[t.Fall=3]="Fall",t[t.WearingJetpack=4]="WearingJetpack",t[t.WearingPropeller=5]="WearingPropeller",t[t.Lose=6]="Lose"}(T||(T={})),function(t){t[t.Left=0]="Left",t[t.Right=1]="Right"}(H||(H={}));class M{constructor(){this.visible=!0}setSize(t){this.size=t}setWidth(t){this.size[1]=t}setHeight(t){this.size[1]=t}setPosition(t){this.position=t}setPositionX(t){this.position[0]=t}setPositionY(t){this.position[1]=t}scaleSize(t){this.size[0]*=t,this.size[1]*=t}getSize(){return this.size}getWidth(){return this.size[0]}getHeight(){return this.size[1]}getPosition(){return this.position}getPositionX(){return this.position[0]}getPositionY(){return this.position[1]}isVisible(){return this.visible}setVisible(t){this.visible=t}containsPoint(t){return this.position[0]<=t[0]&&t[0]<=this.position[0]+this.size[0]&&this.position[1]<=t[1]&&t[1]<=this.position[1]+this.size[1]}collides(t){return this.containsPoint(t.position)||this.containsPoint([t.position[0],t.position[1]+t.size[1]])||this.containsPoint([t.position[0]+t.size[0],t.position[1]])||this.containsPoint([t.position[0]+t.size[0],t.position[1]+t.size[1]])}standOn(t){return t.containsPoint([this.position[0],this.position[1]+this.size[1]])||t.containsPoint([this.position[0]+this.size[0],this.position[1]+this.size[1]])}}class F extends M{constructor(t){super(),this.sprite=A.getInstance().getSprite(t),this.size=this.sprite.getNaturalSize()}setSprite(t){this.sprite=A.getInstance().getSprite(t)}display(t=[0,0]){this.visible&&this.sprite.display([this.position[0]-t[0],this.position[1]-t[1]],this.size)}}class j extends F{constructor(t,e){super(w),this.position=t,this.velocity=e}}const V=[0,-.95],E=[70,810],D=[0,0],Y=[100,-100],J=[0,-1.5],N=[0,.0015];class X{constructor(t){this.AppliedObject=t,this.gravity_acceleration=[...N],this.isAppliedPhysics=!0}setEnable(t){this.isAppliedPhysics=t}isEnabled(){return this.isAppliedPhysics}getVelocity(){return this.velocity}setVelocity(t){this.velocity=t}getVelocityX(){return this.velocity[0]}setVelocityX(t){this.velocity[0]=t}getVelocityY(){return this.velocity[1]}setVelocityY(t){this.velocity[1]=t}update(t){if(!this.AppliedObject)return;let e=this.AppliedObject.getPosition();e[0]+=this.velocity[0]*t,e[1]+=this.velocity[1]*t,this.isAppliedPhysics&&(this.velocity[0]+=this.gravity_acceleration[0]*t,this.velocity[1]+=this.gravity_acceleration[1]*t)}clone(t){let e=new X(t);return e.velocity=[...this.velocity],e.isAppliedPhysics=this.isAppliedPhysics,e}}class W extends F{constructor(){super(c),this.position=[...E],this.state=T.Jump,this.direction=H.Left,this.buffTime=0,this.scaleSize(1.5),this.physicsHandler=new X(this),this.physicsHandler.setVelocity([...J])}resolveBuffPosition(){this.buff&&(this.state==T.WearingPropeller?this.buff.setPosition([this.position[0]+15,this.position[1]]):this.state==T.WearingJetpack&&(this.direction==H.Left?this.buff.setPosition([this.position[0]+this.size[0]-30,this.position[1]+20]):this.buff.setPosition([this.position[0]-this.buff.getWidth()+30,this.position[1]+20])))}autoFall(t){this.physicsHandler.update(t),this.buffTime>0&&(this.buffTime-=t,this.buffTime<=0?(this.buffTime=0,this.buff=null,this.setState(T.Jump),this.physicsHandler.setEnable(!0)):(this.buff.timePassed(t),this.resolveBuffPosition())),this.physicsHandler.getVelocityY()>=0&&this.state==T.Jump&&this.setState(T.Fall)}setVelocityDirection(t){this.direction=t,this.setState(this.state),t===H.Left?this.physicsHandler.setVelocityX(-.4):this.physicsHandler.setVelocityX(.4)}setVelocity(t){this.physicsHandler.setVelocity(t)}setVelocityX(t){this.physicsHandler.setVelocityX(t)}setVelocityY(t){this.physicsHandler.setVelocityY(t)}applyGravity(t){this.physicsHandler.setEnable(t)}getVelocity(){return this.physicsHandler.getVelocity()}getState(){return this.state}update(t){this.autoFall(t)}setBuffTime(t){this.buffTime=t}setBuff(t){this.buff=t}getBuff(){return this.buff}setState(t,e=this.direction){this.state=t,this.direction=e,this.state===T.Jump?e==H.Left?this.setSprite(c):this.setSprite(u):e==H.Right?this.setSprite(l):this.setSprite(h)}shoot(t){return new j(this.position,t)}autoFallInStartScene(t){this.physicsHandler.update(t),this.physicsHandler.getVelocityY()>=0&&this.state==T.Jump&&this.setState(T.Fall)}display(t=[0,0]){super.display(t),this.buff&&this.buff.display(t)}clone(){let t=new W;return t.position=[...this.position],t.size=[...this.size],t.visible=this.visible,t.state=this.state,t.direction=this.direction,t.physicsHandler=this.physicsHandler.clone(t),t.buffTime=this.buffTime,t.sprite=this.sprite,this.buff?t.buff=this.buff.clone():t.buff=null,t}}class _{constructor(){this.highScore=0,this.reset()}reset(){this.player=new W,this.camera=new x,this.camera.focusOn(this.player),this.camera.setTopBound(300),this.lands=[],this.bullets=[],this.monsters=[],this.playerName="Unknown Player",this.score=0}static getInstance(){return _.instance||(_.instance=new _),_.instance}setPlayer(t){this.player=t,this.camera.focusOn(this.player)}getPlayer(){return this.player}getLands(){return this.lands}getMonsters(){return this.monsters}getBullets(){return this.bullets}getCamera(){return this.camera}getScore(){return this.score}getPlayerName(){return this.playerName}setScore(t){this.score=t,this.highScore=Math.max(this.highScore,this.score)}getHighScore(){return this.highScore}}class C extends F{isClicked(t,e){return this.containsPoint([t,e])}}class q{constructor(t){this.range=null,this.sprites=t,this.currentAnimation=0,this.timeDifference=0,this.animationTimeLeft=0}setTimeDifference(t){this.timeDifference=t}setTimeDisplay(t){this.timeDisplay=t}setRangeAnimation(t){this.range=t}setCurrenAnimation(t){this.currentAnimation=t}timePassed(t){this.range&&this.currentAnimation==this.range[1]||0!=this.timeDifference&&(this.animationTimeLeft-=t,this.animationTimeLeft<=0&&(this.animationTimeLeft=this.timeDifference,this.currentAnimation++,this.currentAnimation>=this.sprites.length&&(this.currentAnimation=0)))}getNaturalSize(){return this.sprites[this.currentAnimation].getNaturalSize()}display(t,e){this.sprites[this.currentAnimation].display(t,e)}clone(){let t=new q(this.sprites);return t.currentAnimation=this.currentAnimation,t.timeDifference=this.timeDifference,t.animationTimeLeft=this.animationTimeLeft,t.timeDisplay=this.timeDisplay,this.range?t.range=[...this.range]:t.range=null,t}}class U extends M{constructor(t){super(),this.spritesName=[...t],this.animator=new q(A.getInstance().getAnimationSprite(t)),this.size=this.animator.getNaturalSize()}requestLoopAnimation(){this.animator.setRangeAnimation(null),this.animator.setCurrenAnimation(0),this.animator.setTimeDifference(30)}requestSingleAnimation(t){this.animator.setTimeDifference(0),this.animator.setCurrenAnimation(t),this.animator.setRangeAnimation(null),this.size=this.animator.getNaturalSize()}requestMultipleAnimation(t,e){this.animator.setCurrenAnimation(t),this.animator.setRangeAnimation([t,e]),this.animator.setTimeDifference(30)}timePassed(t){this.animator.timePassed(t)}display(t=[0,0]){this.visible&&this.animator.display([this.position[0]-t[0],this.position[1]-t[1]],this.size)}cloneAnimator(){return this.animator.clone()}setAnimator(t){this.animator=t}}var K;!function(t){t[t.None=0]="None",t[t.Propeller=1]="Propeller",t[t.Jetpack=2]="Jetpack",t[t.Spring=3]="Spring"}(K||(K={}));class G extends U{constructor(t){super(t),this.requestSingleAnimation(0),this.scaleSize(2)}}const Q=[0,-1.3],Z=[0,-1.1],$=[0,-1.3];class tt extends G{constructor(){super(P)}onReceived(t){t.setVelocity([...Z]),t.applyGravity(!1),t.setState(T.WearingPropeller),t.setBuffTime(1e3),t.setBuff(this),this.requestLoopAnimation()}clone(){let t=new tt;return t.position=[...this.position],t.size=[...this.size],t.visible=this.visible,t.setAnimator(this.cloneAnimator()),t}}class et extends G{constructor(){super(B)}onReceived(t){t.setVelocity([...$]),t.applyGravity(!1),t.setState(T.WearingJetpack),t.setBuffTime(1e3),t.setBuff(this),this.requestLoopAnimation()}clone(){let t=new et;return t.position=[...this.position],t.size=[...this.size],t.visible=this.visible,t.setAnimator(this.cloneAnimator()),t}}class st extends G{constructor(){super(S)}onReceived(t){t.setState(T.Jump),t.setVelocity([...Q]);let e=[this.position[0],this.position[1]+this.size[1]];this.requestSingleAnimation(1),this.scaleSize(2),this.position=[e[0],e[1]-this.size[1]]}clone(){let t=new st;return t.position=[...this.position],t.size=[...this.size],t.visible=this.visible,t.setAnimator(this.cloneAnimator()),t}}class it{constructor(){this.Speed=60}static getInstance(){return it.instance||(it.instance=new it),it.instance}getRandomInt(t,e){const s=Math.ceil(t),i=Math.floor(e);return Math.floor(Math.random()*(i-s)+s)}getRandomFloat(t,e){return Math.random()*(e-t)+t}}class ot extends F{constructor(){super(y),this.scaleSize(2)}setPositionForBuff(){let t=it.getInstance();this.buff.setPosition([this.position[0]+t.getRandomFloat(0,this.size[0]-this.buff.getWidth()),this.position[1]-this.buff.getHeight()])}randomizeBuff(){switch(it.getInstance().getRandomInt(0,30)){case K.Propeller:this.buff=new tt,this.setPositionForBuff();break;case K.Jetpack:this.buff=new et,this.setPositionForBuff();break;case K.Spring:this.buff=new st,this.setPositionForBuff()}}onJumped(t){this.buff&&t.collides(this.buff)?this.buff.onReceived(t):(t.setVelocity([...V]),t.setState(T.Jump))}move(t){}display(t){super.display(t),this.buff&&this.buff.display(t)}}class nt{constructor(){this.keyDownEventListener=t=>{this.keyInputDowned=t.key},this.keyUpEventListener=t=>{this.keyInputReleased=t.key},this.keyInputDowned="",this.keyInputReleased="",window.addEventListener("keydown",this.keyDownEventListener),window.addEventListener("keyup",this.keyUpEventListener)}pressed(t){return this.keyInputDowned==t&&(this.keyInputDowned="",!0)}released(t){return this.keyInputReleased==t&&(this.keyInputReleased="",!0)}}class at{constructor(){this.mouseClickEventListener=t=>{const e=document.getElementById("game").getBoundingClientRect(),s=t.clientX-e.left,i=t.clientY-e.top;this.mousePosition=[s,i]},this.mousePosition=[-1,-1],document.getElementById("game").addEventListener("click",this.mouseClickEventListener)}clicked(t){return!!t.containsPoint(this.mousePosition)&&(this.mousePosition=[-1,-1],!0)}}class rt{constructor(){this.mouseInput=new at,this.keyboardInput=new nt}setContext(t){this.context=t}}const ht=[70,500],lt=[590,0],ct=[580,0],ut=[60,650],pt=[350,650],dt=[0,0],gt=[0,0],mt=[0,750],yt=[120,580],ft=[100,100],bt=[60,350],Pt=[60,440],Bt=[60,530];class St extends rt{constructor(){super(),this.loadResources(),document.getElementById("game")}loadResources(){this.background=new F(o),this.background.setPosition([...dt]),this.topBackground=new F(n),this.topBackground.setPosition([...gt]),this.resumeButton=new C(m),this.resumeButton.scaleSize(1.2),this.resumeButton.setPosition([...lt])}render(){this.background.display(),this.topBackground.display(),this.resumeButton.display()}processInput(){this.mouseInput.clicked(this.resumeButton)&&this.context.transitionTo(new jt)}update(t){}}class wt extends M{constructor(t="0"){super(),this.text=t,this.font="DoodleJump",this.size=[0,30]}setText(t){this.text=t}getText(){return this.text}display(t=[0,0]){if(!this.visible)return;const e=document.getElementById("game").getContext("2d");e&&(e.font=this.size[1].toString()+"px "+this.font,e.fillText(this.text,this.position[0],this.position[1]))}}class vt extends rt{constructor(){super(),this.dataManager=_.getInstance(),this.loadResources(),document.getElementById("game")}loadResources(){this.background=new F(i),this.background.setPosition([...dt]),this.topBackground=new F(n),this.topBackground.setPosition([...gt]),this.bottomBackground=new F(a),this.bottomBackground.setPosition([...mt]),this.gameOverBackground=new F(v),this.gameOverBackground.setPosition([...ft]),this.score=this.dataManager.getScore(),this.highScore=this.dataManager.getHighScore(),this.playerName=this.dataManager.getPlayerName(),this.yourScoreObject=new wt("YOUR SCORE: "+this.score.toString()),this.yourScoreObject.setPosition([...bt]),this.yourScoreObject.setHeight(40),this.yourHighScoreObject=new wt("YOUR HIGH SCORE: "+this.highScore.toString()),this.yourHighScoreObject.setPosition([...Pt]),this.yourHighScoreObject.setHeight(40),this.yourNameObject=new wt("YOUR NAME: "+this.playerName),this.yourNameObject.setPosition([...Bt]),this.yourNameObject.setHeight(40),this.playAgainButton=new C(g),this.playAgainButton.setPosition([...ut]),this.menuButton=new C(k),this.menuButton.setPosition([...pt])}processInput(){this.mouseInput.clicked(this.playAgainButton)?(this.dataManager.reset(),this.context.transitionTo(new jt)):this.mouseInput.clicked(this.menuButton)&&this.context.transitionTo(new Vt)}update(t){}render(){this.background.display(),this.topBackground.display(),this.bottomBackground.display(),this.gameOverBackground.display(),this.playAgainButton.display(),this.menuButton.display(),this.yourScoreObject.display(),this.yourHighScoreObject.display(),this.yourNameObject.display()}}var kt,Ot;!function(t){t[t.NormalLand=0]="NormalLand",t[t.MovingLand=1]="MovingLand",t[t.DustLand=2]="DustLand"}(kt||(kt={})),function(t){t[t.None=0]="None",t[t.BlueWingsMonster=1]="BlueWingsMonster",t[t.AlienMonster=2]="AlienMonster"}(Ot||(Ot={}));class zt extends U{constructor(t){super(t),this.scaleSize(1.5)}onCollision(t){t.setState(T.Lose)}}const It=25,Rt=[.15,0],At=[0,.8];class Lt extends F{constructor(){super(f),this.scaleSize(2),this.velocity=[...Rt]}setPositionForBuff(){let t=it.getInstance();this.buff.setPosition([this.position[0]+t.getRandomFloat(0,this.size[0]-this.buff.getWidth()),this.position[1]-this.buff.getHeight()])}randomizeBuff(){switch(it.getInstance().getRandomInt(0,30)){case K.Propeller:this.buff=new tt,this.setPositionForBuff();break;case K.Jetpack:this.buff=new et,this.setPositionForBuff();break;case K.Spring:this.buff=new st,this.setPositionForBuff()}}move(t){let s=[0,0];this.buff&&(s=this.buff.getPosition()),this.position[0]>=e-this.size[0]?(s[0]-=this.position[0]-(e-this.size[0]),this.position[0]=e-this.size[0],this.velocity[0]=-this.velocity[0]):this.position[0]<=0&&(s[0]-=this.position[0],this.position[0]=0,this.velocity[0]=-this.velocity[0]),this.position[1]+=t*this.velocity[1],this.position[0]+=t*this.velocity[0],s[0]+=t*this.velocity[0],s[1]+=t*this.velocity[1]}onJumped(t){this.buff&&t.collides(this.buff)?this.buff.onReceived(t):(t.setVelocity([...V]),t.setState(T.Jump))}display(t){super.display(t),this.buff&&this.buff.display(t)}}class xt extends U{constructor(){super(b),this.velocity=[0,0],this.scaleSize(2)}onJumped(t){this.requestMultipleAnimation(1,3),this.velocity=[...At]}randomizeBuff(){}move(t){this.position[0]+=this.velocity[0]*t,this.position[1]+=this.velocity[1]*t,this.timePassed(t)}}const Tt=[.3,0],Ht=[.2,0];class Mt extends zt{constructor(){super(O),this.velocity=[...Tt],this.requestLoopAnimation()}move(t){this.position[0]>=e-this.size[0]?(this.position[0]=e-this.size[0],this.velocity[0]=-this.velocity[0]):this.position[0]<=0&&(this.position[0]=0,this.velocity[0]=-this.velocity[0]),this.position[1]+=t*this.velocity[1],this.position[0]+=t*this.velocity[0]}}class Ft extends zt{constructor(){super(z),this.requestSingleAnimation(0),this.velocity=[...Ht]}move(t){this.position[0]>=e-this.size[0]?(this.position[0]=e-this.size[0],this.velocity[0]=-this.velocity[0],this.requestSingleAnimation(1)):this.position[0]<=0&&(this.position[0]=0,this.velocity[0]=-this.velocity[0],this.requestSingleAnimation(0)),this.position[1]+=t*this.velocity[1],this.position[0]+=t*this.velocity[0]}}class jt extends rt{constructor(){super(),this.dataManager=_.getInstance(),this.loadResources()}loadResources(){this.temporaryPlayer=null,this.player=this.dataManager.getPlayer(),this.lands=this.dataManager.getLands(),this.monsters=this.dataManager.getMonsters(),this.bullets=this.dataManager.getBullets(),this.background=new F(i),this.background.setPosition([...dt]),this.topBackground=new F(n),this.topBackground.setPosition([...gt]),this.pauseButton=new C(d),this.pauseButton.scaleSize(1.5),this.pauseButton.setPosition([...ct]),this.camera=this.dataManager.getCamera(),this.score=this.dataManager.getScore(),this.scoreObject=new wt(this.score.toString()),this.scoreObject.setPosition([0,50]),this.scoreObject.setHeight(50)}processInput(){this.mouseInputProcessing(),this.keyboardInputProcessing()}render(){const t=document.getElementById("game"),e=t.getContext("2d");if(!e)return;e.clearRect(0,0,t.width,t.height);let s=this.camera.getOffset();this.background.display(),this.lands.forEach((t=>{t.display(s)})),this.player.display(s),this.temporaryPlayer&&this.temporaryPlayer.display(s),this.monsters.forEach((t=>{t.display(s)})),this.topBackground.display(),this.pauseButton.display(),this.scoreObject.display()}update(t){if(this.monsters.forEach((t=>{this.player.collides(t)&&t.onCollision(this.player)})),this.camera.isOutOfBottomRange(this.player)&&this.player.getState()==T.Fall||this.player.getState()==T.Lose)return this.dataManager.setScore(this.score),void this.context.transitionTo(new vt);this.lands.forEach((t=>{this.player.standOn(t)&&this.player.getState()==T.Fall&&t.onJumped(this.player)})),this.updateMap(t),this.player.autoFall(t),this.score=Math.round(Math.max(this.score,E[1]-this.player.getPositionY())),this.player.getPositionX()<0?this.player.getPositionX()+this.player.getWidth()>0?this.temporaryPlayer||(this.temporaryPlayer=this.player.clone(),this.temporaryPlayer.setPositionX(this.player.getPositionX()+e)):(this.player=this.temporaryPlayer,this.camera.focusOn(this.player),this.temporaryPlayer=null):this.player.getPositionX()+this.player.getWidth()>e?this.player.getPositionX()<e?this.temporaryPlayer||(this.temporaryPlayer=this.player.clone(),this.temporaryPlayer.setPositionX(this.player.getPositionX()-e)):(this.player=this.temporaryPlayer,this.camera.focusOn(this.player),this.temporaryPlayer=null):this.temporaryPlayer=null,this.temporaryPlayer&&this.temporaryPlayer.autoFall(t),this.scoreObject.setText(this.score.toString()),this.camera.update()}updateMap(s){for(;this.lands.length>0&&this.camera.isOutOfBottomRange(this.lands[0]);)this.lands.shift();for(;this.monsters.length>0&&this.camera.isOutOfBottomRange(this.monsters[0]);)this.monsters.shift();let i=it.getInstance();for(;0==this.lands.length||this.lands[this.lands.length-1].getPositionY()-this.camera.getOffsetY()>=50;){let s=t;this.lands.length>0&&(s=this.lands[this.lands.length-1].getPositionY());let o=i.getRandomInt(0,3);switch(s-this.lastStandableLandHeight>=30&&(o=i.getRandomInt(0,1)),o){case kt.NormalLand:{let t=new ot;t.setPosition([i.getRandomFloat(0,e-t.getWidth()),i.getRandomFloat(s-It-40,s-It-20)]),t.randomizeBuff(),this.lastStandableLandHeight=t.getPositionY(),this.lands.push(t);break}case kt.MovingLand:{let t=new Lt;t.setPosition([i.getRandomFloat(0,e-t.getWidth()),i.getRandomFloat(s-It-40,s-It-20)]),t.randomizeBuff(),this.lastStandableLandHeight=t.getPositionY(),this.lands.push(t);break}case kt.DustLand:{let t=new xt;t.setPosition([i.getRandomFloat(0,e-t.getWidth()),i.getRandomFloat(s-It-40,s-It-20)]),t.randomizeBuff(),this.lands.push(t);break}}}for(;(this.player.getState()==T.Jump||this.player.getState()==T.Fall)&&(0==this.monsters.length||this.monsters[this.monsters.length-1].getPositionY()-this.camera.getOffsetY()>=700);){let t=0;switch(this.monsters.length>0&&(t=this.monsters[this.monsters.length-1].getPositionY()),i.getRandomInt(0,3)){case Ot.BlueWingsMonster:{let s=new Mt;s.setPosition([i.getRandomFloat(0,e-s.getWidth()),i.getRandomFloat(t-s.getHeight()-2e3,t-s.getHeight()-1500)]),this.monsters.push(s);break}case Ot.AlienMonster:let s=new Ft;s.setPosition([i.getRandomFloat(0,e-s.getWidth()),i.getRandomFloat(t-s.getHeight()-2e3,t-s.getHeight()-1500)]),this.monsters.push(s)}}this.lands.forEach((t=>{t.move(s)})),this.monsters.forEach((t=>{t.move(s),t.timePassed(s)}))}mouseInputProcessing(){this.mouseInput.clicked(this.pauseButton)&&(this.dataManager.setScore(this.score),this.context.transitionTo(new St))}keyboardInputProcessing(){this.keyboardInput.pressed("a")||this.keyboardInput.pressed("ArrowLeft")?(this.player.setVelocityDirection(H.Left),this.temporaryPlayer&&this.temporaryPlayer.setVelocityDirection(H.Left)):this.keyboardInput.pressed("d")||this.keyboardInput.pressed("ArrowRight")?(this.player.setVelocityDirection(H.Right),this.temporaryPlayer&&this.temporaryPlayer.setVelocityDirection(H.Right)):this.keyboardInput.pressed("w")||this.keyboardInput.pressed("ArrowUp"),this.keyboardInput.released("a")||this.keyboardInput.released("ArrowLeft")||this.keyboardInput.released("d")||this.keyboardInput.released("ArrowRight")?(this.player.setVelocityX(0),this.temporaryPlayer&&this.temporaryPlayer.setVelocityX(0)):this.keyboardInput.released("w")||this.keyboardInput.released("ArrowUp")}}class Vt extends rt{constructor(){super(),this.loadResources()}loadResources(){this.background=new F(r),this.background.setHeight(t),this.background.setPosition([...dt]),this.player=new W,this.player.setPosition([...Y]),this.player.setVelocity([...D]),this.playButton=new C(p),this.playButton.setPosition([...ht]),this.land=new ot,this.land.setPosition([...yt])}processInput(){if(this.mouseInput.clicked(this.playButton)){let t=_.getInstance();t.reset(),t.getLands().push(this.land),t.setPlayer(this.player),this.context.transitionTo(new jt)}}update(t){this.player.autoFallInStartScene(t),this.player.standOn(this.land)&&this.player.getState()==T.Fall&&this.land.onJumped(this.player)}render(){const t=document.getElementById("game"),e=t.getContext("2d");e&&(e.clearRect(0,0,t.width,t.height),this.background.display(),this.land.display(),this.player.display(),this.playButton.display())}}(new class extends L{constructor(){super();const s=document.getElementById("game");s.style.marginLeft="400px",s.width=e,s.height=t}run(){this.transitionTo(new Vt),super.run()}}).run()})();